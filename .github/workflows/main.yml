name: üõ°Ô∏è Sentinel AI - DevSecOps Pipeline

# Gatilho: Roda sempre que houver um Push ou Pull Request
on: [push, pull_request]

jobs:
  devsecops-check:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      
    steps:
      # 1. Baixa o c√≥digo do reposit√≥rio para a m√°quina virtual
      - name: Checkout do C√≥digo
        uses: actions/checkout@v3

      # 2. Prepara o ambiente Python
      - name: Configurar Python 3.9
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      # 3. Instala as bibliotecas necess√°rias (AQUI ESTAVA O ERRO)
      - name: Instalar Depend√™ncias
        run: pip install requests boto3

      # 4. Roda o Scanner de Seguran√ßa (Sentinel AI)
      # Injetamos as chaves secretas como vari√°veis de ambiente
      - name: üõ°Ô∏è Executar Sentinel Scan & Report
        env:
          GOOGLE_API_KEY: ${{ secrets.GOOGLE_API_KEY }}
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          AWS_REGION: ${{ secrets.AWS_REGION }} # Ex: us-east-2
        run: python sentinel_scan.py
